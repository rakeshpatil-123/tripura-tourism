<div class="page-container">
  <h2 class="page-title">Application Status</h2>
  <form [formGroup]="filterForm" class="filter-button-row">
    <div class="responsive-filter">
      <div class="form-group small mb-10">
        <app-ilogi-input-date formControlName="fromDate" fieldLabel="From Date" [monthsRange]="24"
          [allowFutureDates]="true" placeholder="DD-MM-YYYY" [mandatory]="true" [readonly]="false">
        </app-ilogi-input-date>
      </div>
      <div class="form-group small mb-10">
        <app-ilogi-input-date formControlName="toDate" fieldLabel="To Date" [monthsRange]="24" [allowFutureDates]="true"
          placeholder="DD-MM-YYYY" [mandatory]="true" [readonly]="false">
        </app-ilogi-input-date>
      </div>
      <div class="form-group small">
        <app-ilogi-select formControlName="department" fieldLabel="Department" placeholder="Select Department"
          [selectOptions]="departments" [enableSearch]="true" [mandatory]="false">
        </app-ilogi-select>
      </div>
      <div class="form-group small">
        <app-ilogi-select formControlName="status" fieldLabel="Status" placeholder="Select Status"
          [selectOptions]="statuses" [enableSearch]="true" [mandatory]="false">
        </app-ilogi-select>
      </div>
    </div>
    <div class="button-align">
      <button type="button" class="btn btn-reset" (click)="reset()">Reset</button>
      <button type="button" class="btn btn-search" (click)="search()">Search</button>
    </div>
  </form>
  <div class="heading-excel-row">
    <h3 class="section-title">APPLICATION STATUS LIST</h3>
    <button class="btn-excel" [disabled]="!data?.length" (click)="exportExcel()">
      <i class="pi pi-file-excel"></i> Excel
    </button>
  </div>
  <div class="table-scroll">
    <table class="data-table">
      <thead>
        <tr>
          <th>Sl. No.</th>
          <th class="col-app-id">Application ID</th>
          <th>Applicant Name</th>
          <th>Department</th>
          <th>Status</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngIf="displayedData.length === 0">
          <td colspan="5" class="no-record">No record found!</td>
        </tr>
        <tr *ngFor="let item of displayedData; let i = index">
          <td>{{ (currentPageSize - 1) * pageSize + i + 1 }}</td>

          <td>{{ item.application_no }}</td>
          <td>{{ item.organization }}</td>
          <td>{{ item.department_name }}</td>
          <td>
            <span [ngClass]="getStatusClass(item.current_status)">
              {{ toTitleCase(item.current_status) }}
            </span>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
  <div class="pagination-wrapper" *ngIf="totalPages > 1">
    <div class="pagination-container">
      <button class="pagination-btn nav-btn" (click)="prevPage()" [disabled]="currentPageSize === 1">
        ◀ Prev
      </button>
      <ng-container *ngFor="let p of totalPagesArray">
        <button class="pagination-number" [class.active]="p === currentPageSize" (click)="goToPage(p)">
          {{ p }}
        </button>
      </ng-container>
      <button class="pagination-btn nav-btn" (click)="nextPage()" [disabled]="currentPageSize === totalPages">
        Next ▶
      </button>
      <div class="page-size-wrapper">
        <label>Rows per page:</label>
        <select [(ngModel)]="pageSize" (change)="onPageSizeChange()">
          <option *ngFor="let size of pageSizeOptions" [value]="size">
            {{ size }}
          </option>
        </select>
      </div>
    </div>
  </div>
</div>