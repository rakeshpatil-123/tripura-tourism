<div class="page-container">
  <h2 class="page-title">User List</h2>
  <form [formGroup]="filterForm" class="filter-form">
    <div class="responsive-filter">
      <div class="form-group small mb-10">
        <app-ilogi-input-date formControlName="fromDate" fieldLabel="From Date" [monthsRange]="24"
          [allowFutureDates]="true" placeholder="DD-MM-YYYY" [mandatory]="false" [readonly]="false">
        </app-ilogi-input-date>
      </div>
      <div class="form-group small mb-10">
        <app-ilogi-input-date formControlName="toDate" fieldLabel="To Date" [monthsRange]="24" [allowFutureDates]="true"
          placeholder="DD-MM-YYYY" [mandatory]="false" [readonly]="false">
        </app-ilogi-input-date>
      </div>
      <div class="form-group small">
        <app-ilogi-select formControlName="department" fieldLabel="Department" fieldId="department"
          [selectOptions]="departments" placeholder="Select Department" [mandatory]="false">
        </app-ilogi-select>
      </div>
      <div class="form-group small">
        <app-ilogi-select formControlName="service" fieldLabel="Service" fieldId="service" [selectOptions]="serviceList"
          placeholder="Select Service" [mandatory]="false">
        </app-ilogi-select>
      </div>
      <div class="button-row proper-buttons">
        <button type="button" class="btn btn-reset" (click)="reset()">Reset</button>
        <button type="button" class="btn btn-search" (click)="search()">Search</button>
      </div>
    </div>
  </form>
  <div class="heading-excel-row">
    <h3 class="section-title">User List View</h3>
    <button class="btn-excel" [disabled]="!users?.length" (click)="exportExcel()">
      <i class="pi pi-file-excel"></i> Excel
    </button>
  </div>
  <div class="table-wrapper">
    <table class="data-table">
      <thead>
        <tr>
          <th>Sl. No.</th>
          <th>Enterprise Name</th>
          <th>Applicant Name</th>
          <th>Contact No</th>
          <th>Email</th>
          <th>Address</th>
          <th>Date of Application</th>
          <th>Query within 7 days</th>
          <th>Query after 7 days</th>
          <th>Date of Receipt of NOC</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngIf="displayedData.length === 0">
          <td colspan="10" class="no-record">No record found!</td>
        </tr>
        <tr *ngFor="let user of displayedData; let i = index">
          <td>{{ (currentPageSize - 1) * pageSize + i + 1 }}</td>
          <td>{{ user.enterpriseName }}</td>
          <td>{{ user.personName }}</td>
          <td>{{ user.contactNo }}</td>
          <td>{{ user.email }}</td>
          <td>{{ user.address }}</td>
          <td>{{ user.dateOfApplication || '---' }}</td>
          <td>{{ user.queryWithin7Days || '---' }}</td>
          <td>{{ user.queryAfter7Days || '---' }}</td>
          <td>{{ user.dateOfReceiptOfNoc || '---' }}</td>
        </tr>
      </tbody>
    </table>
  </div>
  <div class="pagination-wrapper" *ngIf="totalPages > 0">
    <div class="pagination-container">
      <button class="pagination-btn nav-btn" (click)="prevPage()" [disabled]="currentPageSize === 1">
        ◀ Prev
      </button>
      <ng-container *ngFor="let p of totalPagesArray">
        <button class="pagination-number" [class.active]="p === currentPageSize" (click)="goToPage(p)">
          {{ p }}
        </button>
      </ng-container>
      <button class="pagination-btn nav-btn" (click)="nextPage()" [disabled]="currentPageSize === totalPages">
        Next ▶
      </button>
      <div class="page-size-wrapper">
        <label>Rows per page:</label>
        <select [(ngModel)]="pageSize" (change)="onPageSizeChange()">
          <option *ngFor="let size of pageSizeOptions" [value]="size">
            {{ size }}
          </option>
        </select>
      </div>
    </div>
  </div>
</div>