<div class="page-container">
  <h2 class="page-title">JSON → Excel converter</h2>
  <div class="controls">
    <div class="left">
      <input #fileInput type="file" accept=".json,application/json" (change)="onFileChange($event)" />
      <span class="file-name" *ngIf="fileName">{{ fileName }}</span>
    </div>
    <div class="right">
      <input placeholder="Search" [(ngModel)]="searchTerm" (keyup.enter)="search()" />
      <button class="btn" (click)="search()">Search</button>

      <input placeholder="Replace from" [(ngModel)]="replaceFrom" />
      <input placeholder="Replace to" [(ngModel)]="replaceTo" />
      <button class="btn export" (click)="exportExcelFile()" [disabled]="!previewData.length">Download Excel</button>

      <button class="btn" (click)="replaceAll()">Replace with all</button>
    </div>
  </div>
  <div class="preview" *ngIf="filteredData && filteredData.length">
    <h3>Preview ({{ filteredData.length }} rows)</h3>
    <div class="table-wrap">
      <table>
        <thead>
          <tr>
            <th *ngFor="let col of displayedColumns">{{ col }}</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let row of filteredData; let i = index">
            <td *ngFor="let col of displayedColumns" [innerHTML]="getHighlighted(row[col])"></td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
  <div class="empty" *ngIf="!previewData.length">
    No file loaded yet — import a JSON file to preview.
  </div>
</div>