<div class="registration-container">
  <mat-card class="registration-card">
    <mat-card-header>
      <mat-card-title class="registration-title">
        <mat-icon>person_add</mat-icon>
        New User Registration
      </mat-card-title>
    </mat-card-header>

    <mat-card-content>
      <form [formGroup]="registrationForm" (ngSubmit)="onSubmit()" class="registration-form">
        <div class="form-grid">
          
          <ng-container *ngFor="let field of formFields">
            
            <!-- Text, Email, Tel inputs -->
            <mat-form-field *ngIf="field.type === 'text' || field.type === 'email' || field.type === 'tel'" 
                           class="form-field" 
                           [ngClass]="{'half-width': field.name !== 'registeredEnterpriseAddress', 'full-width': field.name === 'registeredEnterpriseAddress'}"
                           appearance="outline">
              <mat-label>
                {{ field.label }}
                <span class="required-asterisk" *ngIf="field.required">*</span>
              </mat-label>
              <input matInput 
                     [type]="field.type"
                     [formControlName]="field.name"
                     [placeholder]="field.placeholder || ''"
                     [required]="field.required">
              <mat-error *ngIf="hasError(field.name)">
                {{ getErrorMessage(field) }}
              </mat-error>
            </mat-form-field>

            <!-- Textarea -->
            <mat-form-field *ngIf="field.type === 'textarea'" 
                           class="form-field full-width"
                           appearance="outline">
              <mat-label>
                {{ field.label }}
                <span class="required-asterisk" *ngIf="field.required">*</span>
              </mat-label>
              <textarea matInput 
                       [formControlName]="field.name"
                       [placeholder]="field.placeholder || ''"
                       [rows]="field.rows || 3"
                       [required]="field.required"></textarea>
              <mat-error *ngIf="hasError(field.name)">
                {{ getErrorMessage(field) }}
              </mat-error>
            </mat-form-field>

            <!-- Radio buttons -->
            <div *ngIf="field.type === 'radio'" class="form-field radio-group">
              <label class="field-label">
                {{ field.label }}
                <span class="required-asterisk" *ngIf="field.required">*</span>
              </label>
              <mat-radio-group [formControlName]="field.name" class="radio-buttons">
                <mat-radio-button *ngFor="let option of field.options" 
                                 [value]="option.value"
                                 class="radio-option">
                  {{ option.label }}
                </mat-radio-button>
              </mat-radio-group>
              <div *ngIf="hasError(field.name)" class="radio-error">
                {{ getErrorMessage(field) }}
              </div>
            </div>

          </ng-container>
        </div>

        <!-- Form Actions with Custom Buttons -->
        <div class="form-actions">
          <app-button 
            type="outline" 
            size="medium"
            text="Reset"
            icon="refresh-cw"
            [disabled]="isSubmitting"
            (clicked)="onReset()">
          </app-button>
          
          <app-button 
            type="primary" 
            size="medium"
            [text]="isSubmitting ? 'Registering...' : 'Register'"
            [icon]="isSubmitting ? '' : 'user-plus'"
            htmlType="submit"
            [disabled]="isSubmitting || registrationForm.invalid">
            <mat-spinner *ngIf="isSubmitting" diameter="16" class="button-spinner"></mat-spinner>
          </app-button>
        </div>
      </form>
    </mat-card-content>
  </mat-card>
</div>