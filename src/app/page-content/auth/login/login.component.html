<!-- login.component.html -->
<div class="page-wrapper">
  <video autoplay muted loop playsinline class="bg-video" aria-hidden="true">
    <source src="assets/videos/tripura-tourism-video.mp4" type="video/mp4" />
    Your browser does not support the video tag.
  </video>

  <div class="bg-overlay" aria-hidden="true"></div>

  <div class="center-stage" role="main" aria-label="Login area">
    <div class="auth-card" >
      <div class="card-inner">
        <header class="card-header" role="banner">
          <a class="brand" aria-label="Home" [attr.href]="resolvePath('/')">
            <img src="assets/logo/tripuratourismlogo.png" alt="Tripura Tourism logo" />
          </a>
          <div class="title-block">
            <h1 class="heading">Sign In</h1>
            <p class="lead">Access your visiting places and bookings</p>
          </div>
        </header>

        <form [formGroup]="loginForm" (ngSubmit)="onSubmit()" class="form-grid" novalidate>
          <div class="input-wrap">
            <app-ilogi-input
              fieldId="user_name"
              fieldLabel="User username"
              [mandatory]="true"
              formControlName="user_name"
              type="text"
              placeholder="Enter username">
            </app-ilogi-input>
            <small class="error-text" *ngIf="loginForm.get('user_name')?.hasError('invalid')">
              Invalid username.
            </small>
          </div>

          <div class="input-wrap">
            <app-ilogi-input
              fieldId="password"
              fieldLabel="Password"
              [mandatory]="true"
              formControlName="password"
              type="password"
              placeholder="Enter your password">
            </app-ilogi-input>
            <small class="error-text" *ngIf="loginForm.get('password')?.hasError('invalid')">
              Invalid password.
            </small>
          </div>

          <div class="captcha-group">
            <div class="captcha-left">
              <canvas #captchaCanvas width="160" height="56" (click)="reloadCaptcha()" class="captcha-canvas"
                title="Click to refresh CAPTCHA" aria-label="CAPTCHA image"></canvas>
            </div>

            <div class="captcha-actions">
              <button type="button" class="reload-btn" (click)="reloadCaptcha()" aria-label="Reload CAPTCHA">
                <svg viewBox="0 0 24 24" width="18" height="18" focusable="false" aria-hidden="true">
                  <path fill="currentColor"
                    d="M12 6V3L8 7l4 4V8c2.76 0 5 2.24 5 5 0 .85-.21 1.65-.58 2.36l1.46 1.19C18.14 15.4 18.5 14.24 18.5 13c0-3.59-2.91-6.5-6.5-6.5zM6.08 5.64L4.62 4.45C3.86 5.59 3.5 6.75 3.5 8c0 3.59 2.91 6.5 6.5 6.5V21l4-4-4-4v3.5c-2.76 0-5-2.24-5-5 0-.85.21-1.65.58-2.36z" />
                </svg>
              </button>
              <small class="captcha-hint">refresh</small>
            </div>
          </div>

          <div class="input-wrap">
            <app-ilogi-input
              fieldId="captcha_input"
              fieldLabel="Enter CAPTCHA"
              [mandatory]="true"
              formControlName="captchaInput"
              type="text"
              placeholder="Enter the characters you see above"
              (input)="checkCaptcha()">
            </app-ilogi-input>
            <small class="error-text" *ngIf="loginForm.get('captchaInput')?.hasError('invalidCaptcha')">
              Invalid CAPTCHA entered. Please try again.
            </small>
          </div>

          <button type="submit" class="btn-submit" [disabled]="!loginForm.valid || !captchaValid" aria-label="Login">
            <span class="btn-text">Login</span>
            <svg class="btn-arrow" viewBox="0 0 24 24" width="18" height="18" aria-hidden="true">
              <path fill="currentColor" d="M12 4l1.41 1.41L8.83 10H20v2H8.83l4.58 4.59L12 18l-7-7z"/>
            </svg>
          </button>

          <div class="form-footer">
            <span class="small">
              New User? <a [attr.href]="resolvePath('/page/registration')" class="register-link">Register Here</a>
            </span>
            <a class="forgot-link" [attr.href]="resolvePath('/page/forgot-password')" aria-label="Forgot password">Forgot
              Password?</a>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Password reset popup -->
  <div class="popup-overlay" *ngIf="goToForgetPassword">
    <div class="popup-content" role="dialog" aria-modal="true" aria-labelledby="popupTitle">
      <div class="success-icon">âœ“</div>
      <h4 id="popupTitle" class="popup-title">Password reset required</h4>
      <div class="popup-details">
        <h5>Please reset your password to continue.</h5>
      </div>
      <button class="btn popup-btn" (click)="goTo()">Reset</button>
    </div>
  </div>
</div>
